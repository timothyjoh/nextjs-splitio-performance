{"ast":null,"code":"var _jsxFileName = \"/Users/timothyjohnson/wrk/leafly/nextjs-splitio-performance/components/SplitProvider.js\";\nvar __jsx = React.createElement;\nimport React, { useMemo } from \"react\";\nimport { SplitProvider, SplitClient } from \"react-splitio\";\nimport nookies from \"nookies\";\nimport nanoid from \"nanoid\";\nconst ANON_COOKIE_KEY = \"leafly_anon\";\nexport const anonymousCookie = ctx => {\n  let anon = nookies.get(ctx)[ANON_COOKIE_KEY];\n\n  if (!anon) {\n    anon = nanoid();\n    nookies.set(ctx, ANON_COOKIE_KEY, anon, {\n      maxAge: 60 * 24 * 60 * 60,\n      path: \"/\",\n      sameSite: \"strict\"\n    });\n  }\n\n  return anon;\n};\n\nconst NewSplitProvider = ({\n  trafficType,\n  splitKey,\n  children\n}) => {\n  const config = useMemo(() => ({\n    core: {\n      authorizationKey: 'js604eki2au6d26oetgbj33jfi1t3i3dh4ov',\n      trafficType,\n      labelsEnabled: true\n    },\n    startup: {\n      requestTimeoutBeforeReady: 800,\n      // 800ms\n      retriesOnFailureBeforeReady: 5,\n      // 1 sec\n      readyTimeout: 1.5,\n      // 1.5 sec\n      eventsFirstPushWindow: 10 // 10 sec\n\n    },\n    scheduler: {\n      featuresRefreshRate: 30,\n      // 30 sec\n      segmentsRefreshRate: 60,\n      // 60 sec\n      metricsRefreshRate: 60,\n      // 60 sec\n      impressionsRefreshRate: 60,\n      // 60 sec\n      eventsPushRate: 15,\n      // 60 sec\n      eventsQueueSize: 500 // 500 items\n\n    }\n  }), [trafficType]);\n  return __jsx(SplitProvider, {\n    config: config,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 48\n    },\n    __self: this\n  }, __jsx(SplitClient, {\n    splitKey: splitKey || anonymousCookie(),\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 49\n    },\n    __self: this\n  }, children));\n};\n\nexport default NewSplitProvider;","map":{"version":3,"sources":["/Users/timothyjohnson/wrk/leafly/nextjs-splitio-performance/components/SplitProvider.js"],"names":["React","useMemo","SplitProvider","SplitClient","nookies","nanoid","ANON_COOKIE_KEY","anonymousCookie","ctx","anon","get","set","maxAge","path","sameSite","NewSplitProvider","trafficType","splitKey","children","config","core","authorizationKey","labelsEnabled","startup","requestTimeoutBeforeReady","retriesOnFailureBeforeReady","readyTimeout","eventsFirstPushWindow","scheduler","featuresRefreshRate","segmentsRefreshRate","metricsRefreshRate","impressionsRefreshRate","eventsPushRate","eventsQueueSize"],"mappings":";;AAAA,OAAOA,KAAP,IAAgBC,OAAhB,QAA+B,OAA/B;AACA,SAASC,aAAT,EAAwBC,WAAxB,QAA2C,eAA3C;AACA,OAAOC,OAAP,MAAoB,SAApB;AACA,OAAOC,MAAP,MAAmB,QAAnB;AAEA,MAAMC,eAAe,GAAG,aAAxB;AAEA,OAAO,MAAMC,eAAe,GAAGC,GAAG,IAAI;AACpC,MAAIC,IAAI,GAAGL,OAAO,CAACM,GAAR,CAAYF,GAAZ,EAAiBF,eAAjB,CAAX;;AACA,MAAI,CAACG,IAAL,EAAW;AACTA,IAAAA,IAAI,GAAGJ,MAAM,EAAb;AACAD,IAAAA,OAAO,CAACO,GAAR,CAAYH,GAAZ,EAAiBF,eAAjB,EAAkCG,IAAlC,EAAwC;AACtCG,MAAAA,MAAM,EAAE,KAAK,EAAL,GAAU,EAAV,GAAe,EADe;AAEtCC,MAAAA,IAAI,EAAE,GAFgC;AAGtCC,MAAAA,QAAQ,EAAE;AAH4B,KAAxC;AAKD;;AAED,SAAOL,IAAP;AACD,CAZM;;AAcP,MAAMM,gBAAgB,GAAG,CAAC;AAAEC,EAAAA,WAAF;AAAeC,EAAAA,QAAf;AAAyBC,EAAAA;AAAzB,CAAD,KAAyC;AAChE,QAAMC,MAAM,GAAGlB,OAAO,CACpB,OAAO;AACLmB,IAAAA,IAAI,EAAE;AACJC,MAAAA,gBAAgB,EAAE,sCADd;AAEJL,MAAAA,WAFI;AAGJM,MAAAA,aAAa,EAAE;AAHX,KADD;AAMLC,IAAAA,OAAO,EAAE;AACPC,MAAAA,yBAAyB,EAAE,GADpB;AACyB;AAChCC,MAAAA,2BAA2B,EAAE,CAFtB;AAEyB;AAChCC,MAAAA,YAAY,EAAE,GAHP;AAGY;AACnBC,MAAAA,qBAAqB,EAAE,EAJhB,CAImB;;AAJnB,KANJ;AAYLC,IAAAA,SAAS,EAAE;AACTC,MAAAA,mBAAmB,EAAE,EADZ;AACgB;AACzBC,MAAAA,mBAAmB,EAAE,EAFZ;AAEgB;AACzBC,MAAAA,kBAAkB,EAAE,EAHX;AAGe;AACxBC,MAAAA,sBAAsB,EAAE,EAJf;AAImB;AAC5BC,MAAAA,cAAc,EAAE,EALP;AAKW;AACpBC,MAAAA,eAAe,EAAE,GANR,CAMY;;AANZ;AAZN,GAAP,CADoB,EAsBpB,CAAClB,WAAD,CAtBoB,CAAtB;AAwBA,SACE,MAAC,aAAD;AAAe,IAAA,MAAM,EAAEG,MAAvB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KACE,MAAC,WAAD;AAAa,IAAA,QAAQ,EAAEF,QAAQ,IAAIV,eAAe,EAAlD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KACGW,QADH,CADF,CADF;AAOD,CAhCD;;AAiCA,eAAeH,gBAAf","sourcesContent":["import React, { useMemo } from \"react\";\nimport { SplitProvider, SplitClient } from \"react-splitio\";\nimport nookies from \"nookies\";\nimport nanoid from \"nanoid\";\n\nconst ANON_COOKIE_KEY = \"leafly_anon\";\n\nexport const anonymousCookie = ctx => {\n  let anon = nookies.get(ctx)[ANON_COOKIE_KEY];\n  if (!anon) {\n    anon = nanoid();\n    nookies.set(ctx, ANON_COOKIE_KEY, anon, {\n      maxAge: 60 * 24 * 60 * 60,\n      path: \"/\",\n      sameSite: \"strict\"\n    });\n  }\n\n  return anon;\n};\n\nconst NewSplitProvider = ({ trafficType, splitKey, children }) => {\n  const config = useMemo(\n    () => ({\n      core: {\n        authorizationKey: 'js604eki2au6d26oetgbj33jfi1t3i3dh4ov',\n        trafficType,\n        labelsEnabled: true\n      },\n      startup: {\n        requestTimeoutBeforeReady: 800, // 800ms\n        retriesOnFailureBeforeReady: 5, // 1 sec\n        readyTimeout: 1.5, // 1.5 sec\n        eventsFirstPushWindow: 10 // 10 sec\n      },\n      scheduler: {\n        featuresRefreshRate: 30, // 30 sec\n        segmentsRefreshRate: 60, // 60 sec\n        metricsRefreshRate: 60, // 60 sec\n        impressionsRefreshRate: 60, // 60 sec\n        eventsPushRate: 15, // 60 sec\n        eventsQueueSize: 500 // 500 items\n      }\n    }),\n    [trafficType]\n  );\n  return (\n    <SplitProvider config={config}>\n      <SplitClient splitKey={splitKey || anonymousCookie()}>\n        {children}\n      </SplitClient>\n    </SplitProvider>\n  );\n};\nexport default NewSplitProvider;\n"]},"metadata":{},"sourceType":"module"}